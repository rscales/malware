package url_cache

import (
	"log"
	"sync"
)

type LocalURLCache struct {
	mutex sync.Mutex
	urls  map[string]struct{}
}

func (urlCache *LocalURLCache) AddURL(url string) error {
	urlCache.mutex.Lock()
	_, found := urlCache.urls[url]
	if !found {
		log.Printf("updating malware list with url:%s\n", url)
		urlCache.urls[url] = struct{}{}
	}
	urlCache.mutex.Unlock()
	return nil
}

func (urlCache *LocalURLCache) CheckForURL(url string) (bool, error) {
	log.Printf("checking malware list for url:%s\n", url)
	if _, found := urlCache.urls[url]; found {
		log.Printf("malware list contains url:%s\n", url)
		return true, nil
	}
	log.Printf("malware list does not contain url:%s\n", url)
	return false, nil
}
